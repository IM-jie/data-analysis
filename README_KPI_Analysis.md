# KPI Excelæ•°æ®åˆ†æç³»ç»Ÿ

## æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºåˆ†æéƒ¨é—¨KPIæ•°æ®çš„Pythonç³»ç»Ÿï¼Œæ”¯æŒä»Excelæ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œè¿›è¡Œå¼‚å¸¸æ£€æµ‹ã€è¶‹åŠ¿åˆ†æå’Œç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Šã€‚ç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«å­£åº¦æ•°æ®ã€éƒ¨é—¨ä¿¡æ¯å’Œå„ç§KPIæŒ‡æ ‡ï¼Œå¹¶æä¾›å¤šç§å¼‚å¸¸æ£€æµ‹ç®—æ³•æ¥å‘ç°åç¦»å¼‚å¸¸è¶‹åŠ¿çš„æŒ‡æ ‡æ•°æ®ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ” æ•°æ®è¯»å–ä¸å¤„ç†
- **è‡ªåŠ¨åˆ—æ£€æµ‹**: è‡ªåŠ¨è¯†åˆ«å­£åº¦åˆ—ï¼ˆå¦‚2025Q1ã€2025Q2ç­‰ï¼‰ã€éƒ¨é—¨åˆ—å’ŒæŒ‡æ ‡åˆ—
- **æ•°æ®è´¨é‡éªŒè¯**: æ£€æŸ¥ç¼ºå¤±å€¼ã€é‡å¤æ•°æ®ã€æ— æ•ˆå€¼ç­‰æ•°æ®è´¨é‡é—®é¢˜
- **æ•°æ®é‡å¡‘**: æ”¯æŒå®½æ ¼å¼åˆ°é•¿æ ¼å¼çš„æ•°æ®è½¬æ¢ï¼Œä¾¿äºæ—¶é—´åºåˆ—åˆ†æ
- **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒ.xlsxå’Œ.xlsæ ¼å¼çš„Excelæ–‡ä»¶

### ğŸš¨ å¼‚å¸¸æ£€æµ‹
- **å¤šç§ç®—æ³•**: æ”¯æŒIsolation Forestã€LOFã€One-Class SVMã€IQRã€Z-scoreç­‰å¤šç§å¼‚å¸¸æ£€æµ‹æ–¹æ³•
- **è‡ªåŠ¨é˜ˆå€¼**: æ ¹æ®æ•°æ®åˆ†å¸ƒè‡ªåŠ¨è°ƒæ•´å¼‚å¸¸æ£€æµ‹é˜ˆå€¼
- **å¤šç»´åº¦åˆ†æ**: æ”¯æŒå•æŒ‡æ ‡å’Œå¤šæŒ‡æ ‡è”åˆå¼‚å¸¸æ£€æµ‹
- **å¯è§†åŒ–å±•ç¤º**: æä¾›å¼‚å¸¸å€¼çš„æ•£ç‚¹å›¾å’Œçƒ­åŠ›å›¾å±•ç¤º

### ğŸ“ˆ è¶‹åŠ¿åˆ†æ
- **è¶‹åŠ¿æ–œç‡è®¡ç®—**: ä½¿ç”¨çº¿æ€§å›å½’è®¡ç®—æŒ‡æ ‡å˜åŒ–è¶‹åŠ¿
- **å˜åŒ–ç‚¹æ£€æµ‹**: è‡ªåŠ¨è¯†åˆ«è¶‹åŠ¿å˜åŒ–çš„å…³é”®æ—¶é—´ç‚¹
- **å­£èŠ‚æ€§åˆ†æ**: æ£€æµ‹æ•°æ®ä¸­çš„å‘¨æœŸæ€§æ¨¡å¼
- **æ³¢åŠ¨æ€§è¯„ä¼°**: è®¡ç®—æŒ‡æ ‡çš„ç¨³å®šæ€§æŒ‡æ ‡
- **ç§»åŠ¨å¹³å‡**: æä¾›å¹³æ»‘çš„è¶‹åŠ¿çº¿

### ğŸ“Š å¯è§†åŒ–æŠ¥å‘Š
- **HTMLæŠ¥å‘Š**: ç”Ÿæˆç¾è§‚çš„äº¤äº’å¼HTMLåˆ†ææŠ¥å‘Š
- **å¤šç§å›¾è¡¨**: åŒ…å«åˆ†å¸ƒå›¾ã€è¶‹åŠ¿å›¾ã€å¼‚å¸¸æ£€æµ‹å›¾ã€éƒ¨é—¨å¯¹æ¯”å›¾ç­‰
- **æ•°æ®æ‘˜è¦**: æä¾›è¯¦ç»†çš„æ•°æ®ç»Ÿè®¡å’Œæ‘˜è¦ä¿¡æ¯
- **å»ºè®®ç”Ÿæˆ**: åŸºäºåˆ†æç»“æœè‡ªåŠ¨ç”Ÿæˆæ”¹è¿›å»ºè®®

### ğŸ¯ çµæ´»åˆ†æ
- **ç‰¹å®šæŒ‡æ ‡åˆ†æ**: å¯ä»¥é’ˆå¯¹å•ä¸ªæŒ‡æ ‡è¿›è¡Œæ·±å…¥åˆ†æ
- **ç‰¹å®šéƒ¨é—¨åˆ†æ**: å¯ä»¥é’ˆå¯¹å•ä¸ªéƒ¨é—¨è¿›è¡Œä¸“é¡¹åˆ†æ
- **æ‰¹é‡å¤„ç†**: æ”¯æŒå¤„ç†åŒ…å«100+æŒ‡æ ‡çš„å¤§å‹æ•°æ®é›†
- **ç»“æœå¯¼å‡º**: æ”¯æŒå°†åˆ†æç»“æœå¯¼å‡ºä¸ºExcelæ ¼å¼

### ğŸ” æ•°æ®æŒ–æ˜åŠŸèƒ½
- **å…³è”å…³ç³»å‘ç°**: è‡ªåŠ¨å‘ç°æŒ‡æ ‡é—´çš„ç›¸å…³æ€§ã€äº’ä¿¡æ¯å’Œå› æœå…³ç³»
- **å…³è”è§„åˆ™æŒ–æ˜**: ä½¿ç”¨Aprioriç®—æ³•æŒ–æ˜æŒ‡æ ‡é—´çš„å…³è”è§„åˆ™
- **å› æœå…³ç³»åˆ†æ**: åŸºäºæ»åç›¸å…³æ€§åˆ†ææŒ‡æ ‡é—´çš„å› æœå…³ç³»
- **åŸºäºå…³è”å…³ç³»çš„å¼‚å¸¸æ£€æµ‹**: å½“å…³è”å…³ç³»å‘ç”Ÿå˜åŒ–æ—¶è‡ªåŠ¨è¯†åˆ«å¼‚å¸¸
- **ä¸šåŠ¡æ´å¯Ÿç”Ÿæˆ**: åŸºäºæŒ–æ˜ç»“æœç”Ÿæˆä¸šåŠ¡å»ºè®®å’Œæ´å¯Ÿ

### ğŸ—„ï¸ ClickHouseæ•°æ®åº“æ”¯æŒ
- **é«˜æ€§èƒ½æ•°æ®æŸ¥è¯¢**: æ”¯æŒå¤§è§„æ¨¡KPIæ•°æ®åˆ†æ
- **å®æ—¶æ•°æ®å¤„ç†**: æ”¯æŒå®æ—¶æŒ‡æ ‡ç›‘æ§å’Œåˆ†æ
- **å¤æ‚SQLæŸ¥è¯¢**: æ”¯æŒå¤æ‚çš„åˆ†ææŸ¥è¯¢å’Œèšåˆ
- **æ•°æ®å¯¼å‡ºåŠŸèƒ½**: æ”¯æŒå¯¼å‡ºåˆ°Excelæ ¼å¼
- **é›†æˆåˆ†æ**: ä¸æ•°æ®æŒ–æ˜åŠŸèƒ½æ— ç¼é›†æˆ

## ç³»ç»Ÿæ¶æ„

```
data-analysis/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ excel_reader.py          # Excelæ•°æ®è¯»å–å™¨
â”‚   â”œâ”€â”€ analysis/
â”‚   â”‚   â””â”€â”€ kpi_anomaly_detector.py  # å¼‚å¸¸æ£€æµ‹å’Œè¶‹åŠ¿åˆ†æ
â”‚   â”œâ”€â”€ visualization/
â”‚   â”‚   â””â”€â”€ kpi_report_generator.py  # æŠ¥å‘Šç”Ÿæˆå™¨
â”‚   â””â”€â”€ kpi_excel_analyzer.py        # ä¸»åˆ†æå™¨
â”œâ”€â”€ config/
â”‚   â””â”€â”€ kpi_config.yaml              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ reports/                         # æŠ¥å‘Šè¾“å‡ºç›®å½•
â”œâ”€â”€ example_kpi_analysis.py          # ä½¿ç”¨ç¤ºä¾‹
â””â”€â”€ requirements.txt                 # ä¾èµ–åŒ…åˆ—è¡¨
```

## å®‰è£…ä¸é…ç½®

### 1. ç¯å¢ƒè¦æ±‚
- Python 3.8+
- æ¨èä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ

### 2. å®‰è£…ä¾èµ–
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
# æˆ–
.venv\Scripts\activate     # Windows

# å®‰è£…ä¾èµ–åŒ…
pip install -r requirements.txt
```

### 3. ä¾èµ–åŒ…è¯´æ˜
- `pandas`: æ•°æ®å¤„ç†å’Œåˆ†æ
- `numpy`: æ•°å€¼è®¡ç®—
- `scikit-learn`: æœºå™¨å­¦ä¹ ç®—æ³•ï¼ˆå¼‚å¸¸æ£€æµ‹ï¼‰
- `plotly`: äº¤äº’å¼å›¾è¡¨
- `matplotlib/seaborn`: é™æ€å›¾è¡¨
- `openpyxl/xlrd`: Excelæ–‡ä»¶è¯»å†™
- `jinja2`: HTMLæ¨¡æ¿å¼•æ“
- `loguru`: æ—¥å¿—è®°å½•

## ä½¿ç”¨æ–¹æ³•

### 1. å¿«é€Ÿå¼€å§‹

#### åˆ›å»ºç¤ºä¾‹æ•°æ®å¹¶è¿è¡Œåˆ†æ
```bash
# è¿è¡Œå®Œæ•´ç¤ºä¾‹
python example_kpi_analysis.py
```

#### ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·
```bash
# åˆ›å»ºç¤ºä¾‹Excelæ–‡ä»¶
python src/kpi_excel_analyzer.py --create-sample

# åˆ†æExcelæ–‡ä»¶
python src/kpi_excel_analyzer.py your_kpi_data.xlsx

# åˆ†æç‰¹å®šæŒ‡æ ‡
python src/kpi_excel_analyzer.py your_kpi_data.xlsx --metric "åœ¨ç¼–äººæ•°"

# åˆ†æç‰¹å®šéƒ¨é—¨
python src/kpi_excel_analyzer.py your_kpi_data.xlsx --department "æŠ€æœ¯éƒ¨"

# è¿›è¡Œå…³è”å…³ç³»åˆ†æ
python src/kpi_excel_analyzer.py your_kpi_data.xlsx --associations

# å¯¼å‡ºç»“æœåˆ°Excel
python src/kpi_excel_analyzer.py your_kpi_data.xlsx --export-excel results.xlsx

# ClickHouseæ•°æ®åº“åˆ†æ
python src/kpi_clickhouse_analyzer.py --table kpi_data --action analyze
python src/kpi_clickhouse_analyzer.py --table kpi_data --action correlations --metrics project_count employee_count
python src/kpi_clickhouse_analyzer.py --table kpi_data --action associations --metrics project_count test_case_count
```

### 2. ç¼–ç¨‹æ¥å£ä½¿ç”¨

#### åŸºç¡€åˆ†æ
```python
from src.kpi_excel_analyzer import KPIExcelAnalyzer

# åˆå§‹åŒ–åˆ†æå™¨
analyzer = KPIExcelAnalyzer()

# è¿›è¡Œå®Œæ•´åˆ†æ
results = analyzer.analyze_excel_file("your_kpi_data.xlsx")

# æŸ¥çœ‹ç»“æœ
print(f"æŠ¥å‘Šè·¯å¾„: {results['report_path']}")
print(f"å¼‚å¸¸æŒ‡æ ‡æ•°é‡: {len(results['analysis_results']['anomalies'])}")
```

#### ç‰¹å®šæŒ‡æ ‡åˆ†æ
```python
# åˆ†æç‰¹å®šæŒ‡æ ‡
results = analyzer.analyze_specific_metric("your_kpi_data.xlsx", "åœ¨ç¼–äººæ•°")

# è·å–å¼‚å¸¸æ£€æµ‹ç»“æœ
anomalies = results['analysis_results']['anomalies']
for method, result in anomalies['value'].items():
    if result.get('anomalies'):
        count = sum(result['anomalies'])
        print(f"{method}: {count}ä¸ªå¼‚å¸¸")
```

#### æ‰‹åŠ¨åˆ†ææµç¨‹
```python
from src.utils.excel_reader import ExcelKPIReader
from src.analysis.kpi_anomaly_detector import KPIComprehensiveAnalyzer

# 1. è¯»å–æ•°æ®
reader = ExcelKPIReader("your_kpi_data.xlsx")
data = reader.read_excel()

# 2. æ£€æµ‹åˆ—ç±»å‹
column_info = reader.detect_columns()

# 3. è¿›è¡Œå¼‚å¸¸æ£€æµ‹
analyzer = KPIComprehensiveAnalyzer()
results = analyzer.analyze_kpi_data(
    data=data,
    department_column=column_info['department_column'],
    metric_columns=column_info['metric_columns'],
    time_columns=column_info['quarter_columns']
)
```

#### å…³è”å…³ç³»æŒ–æ˜
```python
from src.analysis.kpi_association_miner import KPIAssociationMiner, KPIAssociationAnomalyDetector

# 1. åˆå§‹åŒ–å…³è”å…³ç³»æŒ–æ˜å™¨
miner = KPIAssociationMiner()
detector = KPIAssociationAnomalyDetector(miner)

# 2. å‘ç°å…³è”å…³ç³»
association_results = miner.discover_associations(
    data=data,
    metric_columns=column_info['metric_columns']
)

# 3. æ„å»ºåŸºçº¿å¹¶æ£€æµ‹å¼‚å¸¸
baseline = detector.build_baseline(data, column_info['metric_columns'])
anomalies = detector.detect_association_anomalies(new_data, column_info['metric_columns'])

# 4. ç”Ÿæˆæ´å¯Ÿ
insights = detector.generate_anomaly_insights(anomalies)
```

#### ClickHouseæ•°æ®åº“åˆ†æ
```python
from src.kpi_clickhouse_analyzer import KPIClickHouseAnalyzer

# 1. åˆå§‹åŒ–ClickHouseåˆ†æå™¨
analyzer = KPIClickHouseAnalyzer('config/clickhouse_config.yaml')

# 2. åˆ†ææ•´ä¸ªè¡¨
results = analyzer.analyze_table(
    table_name='kpi_data',
    metric_columns=['project_count', 'employee_count', 'test_case_count']
)

# 3. åˆ†æç‰¹å®šéƒ¨é—¨
dept_results = analyzer.analyze_department(
    table_name='kpi_data',
    department_name='æŠ€æœ¯éƒ¨'
)

# 4. åˆ†ææŒ‡æ ‡ç›¸å…³æ€§
corr_results = analyzer.analyze_correlations(
    table_name='kpi_data',
    metric_columns=['project_count', 'employee_count', 'test_case_count']
)

# 5. è¿›è¡Œå…³è”å…³ç³»æŒ–æ˜
association_results = analyzer.analyze_associations(
    table_name='kpi_data',
    metric_columns=['project_count', 'employee_count', 'test_case_count']
)
```

### 3. Excelæ•°æ®æ ¼å¼è¦æ±‚

#### åŸºæœ¬æ ¼å¼
- **éƒ¨é—¨åˆ—**: åŒ…å«éƒ¨é—¨åç§°çš„åˆ—ï¼ˆå¦‚"éƒ¨é—¨åç§°"ã€"éƒ¨é—¨"ç­‰ï¼‰
- **å­£åº¦åˆ—**: æ ¼å¼ä¸ºYYYYQ[1-4]çš„åˆ—ï¼ˆå¦‚"2025Q1"ã€"2025Q2"ç­‰ï¼‰
- **æŒ‡æ ‡åˆ—**: å…¶ä»–æ•°å€¼åˆ—ä½œä¸ºKPIæŒ‡æ ‡

#### ç¤ºä¾‹æ•°æ®ç»“æ„
| éƒ¨é—¨åç§° | åœ¨ç¼–äººæ•° | æ‰§è¡Œç”¨ä¾‹æ•° | 2025Q1_åœ¨ç¼–äººæ•° | 2025Q1_æ‰§è¡Œç”¨ä¾‹æ•° | 2025Q2_åœ¨ç¼–äººæ•° | 2025Q2_æ‰§è¡Œç”¨ä¾‹æ•° |
|---------|---------|-----------|----------------|------------------|----------------|------------------|
| æŠ€æœ¯éƒ¨   | 50      | 1000      | 45             | 950              | 52             | 1050             |
| äº§å“éƒ¨   | 30      | 500       | 28             | 480              | 32             | 520              |

## é…ç½®è¯´æ˜

### é…ç½®æ–‡ä»¶ (config/kpi_config.yaml)
```yaml
# åˆ†æé…ç½®
analysis_config:
  # åˆ†å¸ƒåˆ†æé…ç½®
  distribution:
    bins: 20
    outlier_method: "iqr"
    
  # è¶‹åŠ¿åˆ†æé…ç½®
  trend:
    window_size: 3
    seasonality: 4
    
  # å¼‚å¸¸æ£€æµ‹é…ç½®
  anomaly:
    method: "isolation_forest"
    contamination: 0.1
    threshold: 0.95

# æŠ¥å‘Šé…ç½®
report_config:
  output_format: ["html"]
  charts:
    - distribution_histogram
    - trend_line
    - anomaly_scatter
  auto_generate: true
```

## å¼‚å¸¸æ£€æµ‹ç®—æ³•

### 1. Isolation Forest
- **åŸç†**: åŸºäºå¼‚å¸¸ç‚¹æ›´å®¹æ˜“è¢«éš”ç¦»çš„ç‰¹æ€§
- **é€‚ç”¨**: é«˜ç»´æ•°æ®ï¼Œè®¡ç®—æ•ˆç‡é«˜
- **å‚æ•°**: contaminationï¼ˆå¼‚å¸¸æ¯”ä¾‹ï¼‰

### 2. Local Outlier Factor (LOF)
- **åŸç†**: åŸºäºå±€éƒ¨å¯†åº¦æ¯”è¾ƒ
- **é€‚ç”¨**: èƒ½å¤Ÿæ£€æµ‹å±€éƒ¨å¼‚å¸¸
- **å‚æ•°**: n_neighborsï¼ˆé‚»å±…æ•°é‡ï¼‰

### 3. IQRæ–¹æ³•
- **åŸç†**: åŸºäºå››åˆ†ä½è·çš„ç»Ÿè®¡æ–¹æ³•
- **é€‚ç”¨**: å•å˜é‡å¼‚å¸¸æ£€æµ‹
- **å‚æ•°**: factorï¼ˆå€æ•°å› å­ï¼Œé»˜è®¤1.5ï¼‰

### 4. Z-scoreæ–¹æ³•
- **åŸç†**: åŸºäºæ ‡å‡†å·®çš„ç»Ÿè®¡æ–¹æ³•
- **é€‚ç”¨**: æ­£æ€åˆ†å¸ƒæ•°æ®
- **å‚æ•°**: thresholdï¼ˆé˜ˆå€¼ï¼Œé»˜è®¤3.0ï¼‰

## è¾“å‡ºç»“æœ

### 1. HTMLæŠ¥å‘Š
- **æ•°æ®æ‘˜è¦**: éƒ¨é—¨æ•°é‡ã€æŒ‡æ ‡æ•°é‡ã€æ•°æ®è´¨é‡ç­‰
- **å¼‚å¸¸æ£€æµ‹ç»“æœ**: å„æŒ‡æ ‡çš„å¼‚å¸¸æ£€æµ‹ç»“æœå’Œå¯è§†åŒ–
- **è¶‹åŠ¿åˆ†æ**: è¶‹åŠ¿æ–œç‡ã€æ³¢åŠ¨æ€§ã€å­£èŠ‚æ€§åˆ†æ
- **éƒ¨é—¨å¯¹æ¯”**: éƒ¨é—¨é—´çš„æŒ‡æ ‡å¯¹æ¯”çƒ­åŠ›å›¾
- **åˆ†æå»ºè®®**: åŸºäºç»“æœçš„æ”¹è¿›å»ºè®®

### 2. Excelå¯¼å‡º
- **æ•°æ®æ‘˜è¦è¡¨**: åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯
- **å¼‚å¸¸æ£€æµ‹ç»“æœè¡¨**: è¯¦ç»†çš„å¼‚å¸¸æ£€æµ‹ç»“æœ
- **è¶‹åŠ¿åˆ†æç»“æœè¡¨**: è¶‹åŠ¿åˆ†ææ•°æ®
- **å»ºè®®è¡¨**: åˆ†æå»ºè®®æ±‡æ€»

### 3. æ§åˆ¶å°è¾“å‡º
- **åˆ†æè¿›åº¦**: å®æ—¶æ˜¾ç¤ºåˆ†æè¿›åº¦
- **æ‘˜è¦ä¿¡æ¯**: å…³é”®æŒ‡æ ‡æ‘˜è¦
- **é”™è¯¯ä¿¡æ¯**: è¯¦ç»†çš„é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯

## æœ€ä½³å®è·µ

### 1. æ•°æ®å‡†å¤‡
- ç¡®ä¿Excelæ–‡ä»¶æ ¼å¼è§„èŒƒ
- æ£€æŸ¥æ•°æ®å®Œæ•´æ€§ï¼Œå¤„ç†ç¼ºå¤±å€¼
- éªŒè¯æ•°å€¼æ•°æ®çš„æœ‰æ•ˆæ€§
- ç»Ÿä¸€åˆ—åå‘½åè§„èŒƒ

### 2. å‚æ•°è°ƒä¼˜
- æ ¹æ®æ•°æ®ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•
- è°ƒæ•´contaminationå‚æ•°æ§åˆ¶å¼‚å¸¸æ£€æµ‹æ•æ„Ÿåº¦
- æ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®è¶‹åŠ¿åˆ†æçª—å£å¤§å°

### 3. ç»“æœè§£è¯»
- ç»“åˆä¸šåŠ¡èƒŒæ™¯ç†è§£å¼‚å¸¸æ£€æµ‹ç»“æœ
- å…³æ³¨è¶‹åŠ¿å˜åŒ–çš„å…³é”®æ—¶é—´ç‚¹
- å¯¹æ¯”ä¸åŒéƒ¨é—¨çš„æŒ‡æ ‡è¡¨ç°
- å®šæœŸæ›´æ–°åˆ†ææ¨¡å‹

### 4. ç³»ç»Ÿç»´æŠ¤
- å®šæœŸæ›´æ–°ä¾èµ–åŒ…ç‰ˆæœ¬
- ç›‘æ§ç³»ç»Ÿæ€§èƒ½å’Œèµ„æºä½¿ç”¨
- å¤‡ä»½é‡è¦çš„åˆ†æç»“æœ
- è®°å½•åˆ†æå‚æ•°å’Œé…ç½®å˜æ›´

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ä¾èµ–åŒ…å®‰è£…å¤±è´¥
```bash
# å‡çº§pip
pip install --upgrade pip

# ä½¿ç”¨å›½å†…é•œåƒ
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

#### 2. Excelæ–‡ä»¶è¯»å–å¤±è´¥
- æ£€æŸ¥æ–‡ä»¶æ ¼å¼æ˜¯å¦ä¸º.xlsxæˆ–.xls
- ç¡®è®¤æ–‡ä»¶æ²¡æœ‰è¢«å…¶ä»–ç¨‹åºå ç”¨
- éªŒè¯æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®

#### 3. å†…å­˜ä¸è¶³
- å‡å°‘åŒæ—¶å¤„ç†çš„æŒ‡æ ‡æ•°é‡
- ä½¿ç”¨æ•°æ®é‡‡æ ·è¿›è¡Œåˆ†æ
- å¢åŠ ç³»ç»Ÿå†…å­˜æˆ–ä½¿ç”¨äº‘æœåŠ¡å™¨

#### 4. å›¾è¡¨æ˜¾ç¤ºå¼‚å¸¸
- æ£€æŸ¥ä¸­æ–‡å­—ä½“æ˜¯å¦æ­£ç¡®å®‰è£…
- ç¡®è®¤plotlyç‰ˆæœ¬å…¼å®¹æ€§
- å°è¯•ä½¿ç”¨ä¸åŒçš„æµè§ˆå™¨æ‰“å¼€HTMLæŠ¥å‘Š

### æ—¥å¿—æŸ¥çœ‹
ç³»ç»Ÿä½¿ç”¨loguruè¿›è¡Œæ—¥å¿—è®°å½•ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼š
```python
from loguru import logger

# è®¾ç½®æ—¥å¿—çº§åˆ«
logger.add("kpi_analysis.log", level="DEBUG")
```

## æ‰©å±•å¼€å‘

### 1. æ·»åŠ æ–°çš„å¼‚å¸¸æ£€æµ‹ç®—æ³•
```python
class CustomAnomalyDetector:
    def detect_anomalies(self, data, **kwargs):
        # å®ç°è‡ªå®šä¹‰å¼‚å¸¸æ£€æµ‹é€»è¾‘
        pass
```

### 2. è‡ªå®šä¹‰æŠ¥å‘Šæ¨¡æ¿
- ä¿®æ”¹`src/visualization/kpi_report_generator.py`ä¸­çš„HTMLæ¨¡æ¿
- æ·»åŠ æ–°çš„å›¾è¡¨ç±»å‹
- è‡ªå®šä¹‰CSSæ ·å¼

### 3. é›†æˆå…¶ä»–æ•°æ®æº
- æ‰©å±•`ExcelKPIReader`ç±»æ”¯æŒå…¶ä»–æ•°æ®æ ¼å¼
- æ·»åŠ æ•°æ®åº“è¿æ¥åŠŸèƒ½
- æ”¯æŒAPIæ•°æ®æ¥å£

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦è§LICENSEæ–‡ä»¶ã€‚

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚åœ¨æäº¤ä»£ç å‰ï¼Œè¯·ç¡®ä¿ï¼š
1. ä»£ç ç¬¦åˆPEP 8è§„èŒƒ
2. æ·»åŠ é€‚å½“çš„æµ‹è¯•ç”¨ä¾‹
3. æ›´æ–°ç›¸å…³æ–‡æ¡£
4. é€šè¿‡æ‰€æœ‰æµ‹è¯•

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤GitHub Issue
- å‘é€é‚®ä»¶è‡³é¡¹ç›®ç»´æŠ¤è€…

---

**æ³¨æ„**: æœ¬ç³»ç»Ÿä»…ç”¨äºæ•°æ®åˆ†æï¼Œä¸ä¿è¯åˆ†æç»“æœçš„å‡†ç¡®æ€§ã€‚åœ¨å®é™…ä¸šåŠ¡å†³ç­–ä¸­ï¼Œè¯·ç»“åˆä¸“ä¸šçŸ¥è¯†å’Œä¸šåŠ¡èƒŒæ™¯è¿›è¡Œç»¼åˆåˆ¤æ–­ã€‚
